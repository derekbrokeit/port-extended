#!/bin/bash
# pup

# output file
PUP_FILE="$HOME/.port.updated"

# updated desired, so remove the latest update file
rm -f $PUP_FILE* &> /dev/null 

# attempt to run in a tmux server
if [[ -x tmwin ]] ; then
    tmwin portupdate 'sudo hili portupdate'" $PUP_FILE" 
else
    portupdate 'sudo hili portupdate'" $PUP_FILE" 
fi

if [[ -e ${PUP_FILE}.exit ]] ; then
  #update completed successfully

  #port installed | awk '{print $1}' | sed '1d' | tr '[:upper:]' '[:lower:]' | uniq  > $LOGS_DIR/port
  #port installed active | sed '1d' | awk '{ print $1,$2}'  > $LOGS_DIR/port
  port installed active | sed '1d' | awk '{ print $1,$2}' | tr '[:upper:]' '[:lower:]' > $LOGS_DIR/port

  rm -f ${PUP_FILE}.exit &> /dev/null
fi 

